var transProgContainer = $('.translation-progress[data-language="<%= @lang_id %>"]');
var specTransProgContainer = $('.translation-progress[data-lang-stream="<%= @lang_stream_id %>"]');
transProgContainer.find('.books').empty();
specTransProgContainer.find('.books').html("<%= j render partial: 'translation_progress_chapters', locals: { language_id: @lang_id, deliverable_id: @deliverable_id } %>");
componentHandler.upgradeElements(specTransProgContainer.find('.books .mdl-tabs').get());
componentHandler.upgradeElements(specTransProgContainer.find('.books .mdlext-accordion').get());
componentHandler.upgradeElements(specTransProgContainer.find('.books .mdl-checkbox').get());

transProgContainer.find('.measurables .mdl-button').removeClass('selected mdl-button--colored');
specTransProgContainer.find('.measurables .mdl-button[data-deliverable="<%= @deliverable_id %>"]').addClass('selected mdl-button--colored');

specTransProgContainer.find('.books input').on('click', function() {
    $(this).closest('.mdl-checkbox').addClass('dirty')
    if ($(this).prop('checked')) {
       const data = $(this).data();
       var tpData = {};
       for (var key in data) {
           if (data.hasOwnProperty(key)) {
               tpData[key + '_id'] = data[key]
           }
       }
       tpData['month'] = $('#translation-progress-month-select-<%= @lang_stream_id %>').val();
       tpData['translation_method'] = $('#translation-progress-method-select-<%= @lang_stream_id %>').val();
       tpData['translation_tool'] = $('#translation-progress-tool-select-<%= @lang_stream_id %>').val();
       $.ajax({
           url: '<%= translation_progresses_path %>',
           type: 'post',
           data: {translation_progress: tpData}
       });
    } else {
        console.log($(this).data('id'));
        $.ajax({
            url: '<%= translation_progress_path %>',
            type: 'delete',
            data: {id: $(this).data('id')}
        });
    }
});